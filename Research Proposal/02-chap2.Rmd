---
chapter: 2
knit: "bookdown::render_book"
---

# Methodology

The first goal of this paper is to construct linear density forecast combinations with parametric models. The results are anticipated to reveal that forecast combinations can deliver improved accuracy over single models, but are not necessarily superior to forecasts obtained from the equally weighted combination.

The next goal is to estimate the unknown parameters of the constituent models and the weight in a single step, and to compare the accuracy of forecasts based on these combinations against the usual combinations process, as well as the equally weighted combination. To measure differences between these forecasts, we will eventually employ forecast accuracy tests, of the type derived in @W96, which measure out-of-sample differences between forecasts.


Before explaining further details, the following notation will be used throughout the paper. A vector time series $\textbf{y}_t$ with a total of $T$ observations will be divided proportionally into two parts, an in-sample period $R$ and an out-of-sample period $P$. The realization of a target variable $y$ at time $t$ is denoted as $y_{t}$. Its future values after the in-sample period is denoted as $y_{\small{R+h}}$, where $h$ is the forecast horizon and $h>0$. The information set at time t, $\mathcal{F}_t$, is comprised of all observed (and known) realizations of $y$ up to time t, i.e., $\mathcal{F}_t = \{y_1, y_2, .., y_t\}$. 



A prediction model $M$ determines the conditional probability density for $\textbf{y}_t$ with unknown parameters $\theta_M$ given the history $\mathcal{F}_{t-1}$, denoted by $f(y_t|\mathcal{F}_{t-1}, \theta_M, M)$. Parameter estimates $\hat\theta_M$ are obtained by maximizing the log likelihood function of the conditional probability density for the in-sample period, i.e., $\hat\theta_M = \text{argmax} \sum^R_{t=1} log f(y_t|\mathcal{F}_{t-1}, M)$. These estimates will be held fixed for the ease of evaluation.


## Forecast Combination: Linear Pools

Based on the idea of linear pooling [@BG69;@HM07;@GA11], a linear combination of two densities $f(y_t)$ is constructed with two constituent densities $f_1(y_t)$ and $f_2(y_t)$:

\begin{equation}
f(y_t) = wf_1(y_t) + (1-w)f_2(y_t)
\end{equation}  

where $w$ is the weight allocated to the first density. Through this construction, the sum of two weights is implied to be 1, which is necessary and sufficient for the combination to be a density function [@GA11].

The optimal weight will be estimated by maximizing the log score function over the in-sample period for all possible sets of the two-model linear combination.

\begin{equation}
\hat{w}_{\text{optimal}} = \text{argmax} \sum^R_{t=1}log \Big[w \ f_1(y_t |\mathcal{F}_{\small{t-1}}, \hat\theta_1) + (1-w) \ f_2(y_t|\mathcal{F}_{\small{t-1}}, \hat\theta_2)\Big] 
\end{equation}  


Following the literature on density forecast evaluation, our initial analysis will focus on using log predictive score functions to measure the accuracy of our density forecasts; see, e.g., @GA11 for a discussion on log score and its use in density forecasting. The log predictive score function for a linear combination of two predictive densities over the forecast horizon $h=1,2,...,P$ (i.e., the out-of-sample period) is defined as follows:

\begin{equation}
\label{eqn:LS}
LS = \sum^P_{h=1} log \Big[ \hat{w}_{\text{optimal}} f_1(y_{\small{R+h}}| \mathcal{F}_{\small{R+h-1}}, \hat\theta_1) + (1-\hat{w}_{\text{optimal}}) \ f_2(y_{\small{R+h}}| \mathcal{F}_{\small{R+h-1}}, \hat\theta_2)\Big].
\end{equation}





