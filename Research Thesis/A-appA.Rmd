---
knit: "bookdown::render_book"
---

\appendix

# Appendix  

```{r, echo=FALSE, eval=FALSE}
citation("tidyverse")
citation("dplyr")
citation("fpp3")
citation("mvtnorm")
citation("gridExtra")
version$version.string
```

All codes are performed in R Statistical Software (version 4.2.1 (2022-06-23)). The packages used are `tidyverse` [@tidy19], `dplyr` [@dplyr23], `fpp3` [@fpp23], `gridExtra` [@gridExtra], and `mvtnorm` [GBMMLSH21].


## Model Specification

The error term, $\epsilon_t$, in each model is assumed to be independent and normally distributed with a zero mean and a constant variance. Each model is independent. Even if using the same notation for unknown parameters across models, the estimators are different.

Exact formulas and explanations of these models can be found in @fpp3. The formula of the conditional variance for the ETS(M,N,N) model is discussed in Chapter 6.3 of @HKOS08.

### Nonstationary S\&P 500 Index

1. ARIMA(1,1,1) model with an intercept of the natural logarithm of S\&P 500 index. 
\begin{equation*}
log(y_t) = c + log(y_{t-1}) + \phi_1\big[log(y_{t-1})-log(y_{t-2})\big] + \epsilon_t + \theta_1\epsilon_{t-1}
\end{equation*}

2. ETS(M,N,N) model of the natural logarithm of S\&P 500 index. 
\begin{align*}
log(y_t) &= \ell_{t-1} (1+\epsilon_t) \\
\ell_t &= \ell_{t-1} (1+\alpha \epsilon_t) \\
\end{align*}

3. A classical linear regression model of the natural logarithm of the S\&P 500 index and ARIMA(1,0,0) errors. 
\begin{align*}
log(y_t) &= \beta_0 + \beta_1 t + u_t \\
u_t &= \phi_1 u_{t-1} + \epsilon_t
\end{align*}



### Stationary S\&P 500 Index

1. ARMA(1,1) model with an intercept of the natural logarithm of S\&P 500 returns. 
\begin{equation*}
log(y_t) - log(y_{t-1}) = c + \phi_1\big[log(y_{t-1})-log(y_{t-2})\big] + \epsilon_t + \theta_1\epsilon_{t-1}
\end{equation*}

2. A classical linear regression model of the natural logarithm of the S\&P 500 returns and ARMA(1,1) errors. 
\begin{align*}
log(y_t) &= \beta_0 + u_t \\
u_t &= \phi_1 u_{t-1} + \epsilon_t + \theta_1\epsilon_{t-1}
\end{align*}



### Well-specified models for seasonal unemployment dataset

1. ARIMA(2,0,2)(0,1,1)[4] model with an intercept of the natural logarithm of unemployed individuals.
\begin{align*}
log(y_t) &= c + log(y_{t-4}) + \phi_1\big[log(y_{t-1})-log(y_{t-5})\big] + \phi_2\big[log(y_{t-2})-log(y_{t-6})\big] \\
         &+ \epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \Theta_1\epsilon_{t-4} + \theta_1\Theta_1\epsilon_{t-5} + \theta_2\Theta_1\epsilon_{t-6} \\
\end{align*}


2. ETS(A,A,A) model of the natural logarithm of unemployed individuals. 
\begin{align*}
log(y_t) &= \ell_{t-1} + b_{t-1} + s_{t-m} + \epsilon_t \\
\ell_t &= \ell_{t-1} + b_{t-1} + \alpha \epsilon_t \\
b_t &= b_{t-1} + \beta \epsilon_t \\
s_{t} &= s_{t-m} + \gamma \epsilon_t
\end{align*}



### Poorly-specified models for seasonal unemployment dataset

1. ARIMA(2,1,0) model with an intercept of the natural logarithm of unemployed individuals.
\begin{equation*}
log(y_t) = c + log(y_{t-1}) + \phi_1\big[log(y_{t-1})-log(y_{t-2})\big] + \phi_2\big[log(y_{t-2})-log(y_{t-3})\big] + \epsilon_t
\end{equation*}

2. ETS(A,A,N) model of the natural logarithm of unemployed individuals. 
\begin{align*}
log(y_t) &= \ell_{t-1} + b_{t-1} + \epsilon_t \\
\ell_t &= \ell_{t-1} + b_{t-1} + \alpha \epsilon_t \\
b_t &= b_{t-1} + \beta \epsilon_t
\end{align*}





## In-sample and out-of-sample combination plot {#plot}

\begin{figure}[ht]
\centering
\includegraphics[scale=0.18, angle=90]{figures/betamag11.jpg}
\caption{$\beta_1$ and $\beta_2$ have the same sign but different magnitudes. The first and third columns $\beta_1=2$ and $\beta_2=4$, and the second and fourth columns $\beta_1=2$ and $\beta_2=6$. The sample size is indicated in the subtitle. Other variables remain unchanged as in the initial set-up.}
\label{fig:magnitude}
\end{figure}



\begin{figure}[ht]
\centering
\includegraphics[scale=0.18, angle=90]{figures/betasign11.jpg}
\caption{$\beta_1$ and $\beta_2$ have the same magnitude but different signs, i.e. $\beta_1=-\beta_2$. The first and third columns $\beta_1=2$ and $\beta_2=-2$, and the second and fourth columns $\beta_1=4$ and $\beta_2=-4$. The sample size is indicated in the subtitle. Other variables remain unchanged as in the initial set-up.}
\label{fig:sign}
\end{figure}



\begin{figure}[ht]
\centering
\includegraphics[scale=0.18, angle=90]{figures/var11.jpg}
\caption{The first and third columns $Var(x_{1i}) = 2$ and $Var(x_{2i}) = 1$. The second and fourth columns $Var(x_{1i}) = 4$ and $Var(x_{2i}) = 1$. The sample size is indicated in the subtitle. Other variables remain unchanged as in the initial set-up.}
\label{fig:variance}
\end{figure}






